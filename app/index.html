<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <!-- iOS PWA / Fullscreen support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>Flango 3.2</title>
    <link rel="icon" type="image/png" href="Icons/webp/Assets/FlangoFruitLogo.webp">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@700&family=Nunito:wght@400;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">

    <!-- Modular CSS Architecture -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/products.css">
    <link rel="stylesheet" href="css/users.css">
    <link rel="stylesheet" href="css/features.css">
    <link rel="stylesheet" href="css/events.css">
    <link rel="stylesheet" href="mobile.css">
    <!-- Theme: flango-unstoppable (only active theme - CSS loaded dynamically by theme-loader.js) -->
    <!-- DISABLED: pos-pro.css not in use -->
    <!-- <link rel="stylesheet" href="css/themes/pos-pro.css"> -->
    <style>
        .settings-modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.35);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9998;
        }
        .settings-modal {
            background: #ffffff;
            padding: 16px 20px;
            border-radius: 12px;
            max-width: 420px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        .settings-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            margin-bottom: 12px;
            flex-shrink: 0;
        }
        .settings-modal-title {
            flex: 1;
            margin: 0;
            font-size: 1.25rem;
            text-align: center;
        }
        .modal-back-btn-universal {
            flex-shrink: 0;
            min-width: 80px;
            display: inline-flex;
            align-items: center;
            background: none;
            border: none;
            color: var(--primary-color, #4a90d9);
            font-size: 14px;
            cursor: pointer;
            padding: 6px 8px;
            text-align: left;
            border-radius: 8px;
            transition: background 0.15s, color 0.15s;
        }
        .modal-back-btn-universal:hover {
            background: rgba(74, 144, 217, 0.08);
        }
        .settings-modal-close-btn {
            flex-shrink: 0;
            padding: 6px 14px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            background: #f9fafb;
            font-size: 14px;
            cursor: pointer;
        }
        .settings-modal-close-btn:hover {
            background: #f3f4f6;
        }
        .sugar-policy-settings-disabled {
            opacity: 0.5;
            pointer-events: none;
        }
        .settings-modal-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }
        .settings-modal-actions {
            margin-top: 12px;
            display: flex;
            gap: 10px;
            justify-content: space-between;
        }
        .settings-item-btn {
            width: 100%;
            padding: 8px 12px;
            border-radius: 8px;
            border: none;
            text-align: left;
            cursor: pointer;
        }
        /* Payment Method Cards */
        .payment-method-card {
            background: #ffffff;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            transition: all 0.2s ease;
        }
        .payment-method-card.enabled {
            border-color: var(--primary-color, #2196F3);
            background: #f8f9ff;
        }
        .payment-method-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }
        .payment-method-toggle {
            width: 48px;
            height: 28px;
            position: relative;
            flex-shrink: 0;
        }
        .payment-method-toggle input[type="checkbox"] {
            width: 100%;
            height: 100%;
            appearance: none;
            background: #ccc;
            border-radius: 14px;
            cursor: pointer;
            transition: background 0.3s;
            position: relative;
        }
        .payment-method-toggle input[type="checkbox"]:checked {
            background: #4CAF50;
        }
        .payment-method-toggle input[type="checkbox"]::after {
            content: '';
            position: absolute;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: white;
            top: 3px;
            left: 3px;
            transition: transform 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .payment-method-toggle input[type="checkbox"]:checked::after {
            transform: translateX(20px);
        }
        .payment-method-info {
            flex: 1;
        }
        .payment-method-title-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
        }
        .payment-method-title {
            font-weight: 600;
            font-size: 16px;
            color: #333;
        }
        .payment-method-badge {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: 600;
            white-space: nowrap;
        }
        .badge-green {
            background: #4CAF50;
            color: white;
        }
        .badge-dark-green {
            background: #2E7D32;
            color: white;
        }
        .badge-blue {
            background: #2196F3;
            color: white;
        }
        .badge-orange {
            background: #FF9800;
            color: white;
        }
        .badge-red {
            background: #f44336;
            color: white;
        }
        .badge-gray {
            background: #757575;
            color: white;
        }
        .payment-method-badges {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            align-items: center;
        }
        .payment-method-summary {
            font-size: 15px;
            font-weight: 500;
            color: #333;
            margin-bottom: 12px;
            line-height: 1.5;
        }
        .payment-method-expand {
            font-size: 13px;
            font-weight: 600;
            color: var(--primary-color, #2196F3);
            cursor: pointer;
            text-decoration: underline;
            margin-top: 12px;
            display: none; /* Skjult indtil "more" tekst tilf√∏jes */
        }
        .payment-method-expand.visible {
            display: block !important;
        }
        .payment-method-details {
            display: block;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #eee;
            font-size: 13px;
            color: #555;
            line-height: 1.6;
        }
        .payment-method-more {
            display: none;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #eee;
            font-size: 13px;
            color: #555;
            line-height: 1.6;
        }
        .payment-method-more.expanded {
            display: block;
        }
        .payment-method-fee-policy {
            display: block;
            margin-top: 12px;
            padding: 12px;
            background: #f5f5f5;
            border-radius: 8px;
            opacity: 0.6;
            transition: opacity 0.2s ease;
        }
        .payment-method-card.enabled .payment-method-fee-policy {
            opacity: 1;
        }
        .payment-method-fee-policy input[type="radio"]:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .payment-method-fee-policy label:has(input[type="radio"]:disabled) {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .fee-policy-radio {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .fee-policy-radio label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 14px;
        }
        .fee-policy-tooltip {
            position: relative;
            display: inline-block;
            margin-left: 6px;
        }
        .fee-policy-tooltip-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #2196F3;
            color: white;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            cursor: help;
        }
        .fee-policy-tooltip-content {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 8px;
            padding: 10px;
            background: #333;
            color: white;
            border-radius: 6px;
            font-size: 12px;
            white-space: normal;
            width: 250px;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            line-height: 1.6;
        }
        .fee-policy-tooltip:hover .fee-policy-tooltip-content,
        .payment-method-more .fee-policy-tooltip:hover .fee-policy-tooltip-content {
            display: block;
        }
        .stripe-status-section {
            margin-top: 16px;
            padding: 12px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        .stripe-mode-label {
            font-size: 13px;
            color: #666;
        }
        .stripe-mode-label strong {
            color: #333;
            font-weight: 600;
        }
        .stripe-mode-option:has(input[name="stripe-mode"]:checked) {
            border-color: var(--primary-color, #2196F3);
            background: #f0f7ff;
        }
        .stripe-mode-option:has(input[name="stripe-mode"]:checked) .font-weight-600 {
            color: var(--primary-color, #2196F3);
        }
        .payment-method-config-btn {
            margin-top: 12px;
            padding: 8px 16px;
            background: var(--primary-color, #2196F3);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
        }
        .payment-method-config-btn:hover {
            opacity: 0.9;
        }
        .payment-warning {
            padding: 12px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 6px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #856404;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <!-- Pr√¶-login: Klub login -->
    <div id="screen-club-login" class="login-container" style="display: none;">
        <img class="login-logo" src="Icons/webp/Assets/flango-logo.webp" alt="Flango Logo">
        <div class="lock-icon">üè°</div>
        <h1>Klub login</h1>
        <label for="club-institution-select">V√¶lg institution</label>
        <select id="club-institution-select"></select>
        <label for="club-code-input">Klubbens login-kode</label>
        <input type="password" id="club-code-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="8" inputmode="numeric">
        <button id="club-login-btn">Forts√¶t</button>
        <p id="club-login-error" class="login-error"></p>
    </div>

    <!-- Tilstand 1: Caf√©en er l√•st -->
    <div id="screen-locked" class="login-container">
        <img class="login-logo" src="Icons/webp/Assets/flango-logo.webp" alt="Flango Logo">
        <div class="lock-icon">üîí</div>
        <h1>Caf√©en er l√•st</h1>
        <p id="active-club-label" class="login-subtitle"></p>
        <label for="admin-user-select">V√¶lg administrator</label>
        <select id="admin-user-select">
            <option value="">‚Äî V√¶lg administrator ‚Äî</option>
        </select>
        <input type="email" id="admin-email-input" placeholder="Admin e-mail" autocomplete="off">
        <input type="password" id="admin-password-input" placeholder="Adgangskode" autocomplete="new-password">
        <button id="admin-login-btn">L√•s op & Log ind</button>
        <button id="developer-login-btn" class="secondary-action">Developer Login</button>
        <button id="switch-club-btn" class="switch-club-btn" style="display: none;">Skift klub</button>
        <p id="locked-screen-error" class="login-error"></p>
    </div>

    <!-- Tilstand 2: Admin er logget ind (Kontrolrum) -->
    <div id="screen-admin-login" class="login-container" style="display: none;">
        <img class="login-logo" src="Icons/webp/Assets/flango-logo.webp" alt="Flango Logo">
        <div class="lock-icon">üîì</div>
        <h1 id="admin-welcome-text"></h1>
        <div class="login-options">
            <button id="select-clerk-btn">Log ind som Barn/Ekspedient</button>
            <button id="continue-as-admin-btn">Forts√¶t som Admin</button>
            <button id="lock-cafe-btn" class="secondary-action">Log ud & L√•s Caf√©</button>
        </div>
    </div>

    <!-- Tilstand 3: Caf√©-UI (eksisterende app) -->
    <div id="main-app" style="display: none;">
        <div class="sidebar-main-header">
            <div class="header-actions">
                <button id="logged-in-user-avatar-container" class="header-action-btn" title="Min Flango"></button>
                <button id="toolbar-history-btn" class="header-action-btn" title="Historik"><img src="Icons/webp/Function/historik.webp" alt="Historik"></button>
                <button id="toolbar-db-history-btn" class="header-action-btn" title="DB-Historik" style="display: none;"><img src="Icons/webp/Function/Gear2.webp" alt="DB-Historik"></button>
                <button id="toolbar-gear-btn" class="header-action-btn" title="Indstillinger"><img src="Icons/webp/Function/Gear2.webp" alt="Indstillinger"></button>
                <button id="logout-btn" class="header-action-btn" title="Log ud"><img src="Icons/webp/Function/Logout.webp" alt="Log ud"></button>
                <button id="flango-logo-button" class="header-action-btn" title="Hj√¶lp"><img src="Icons/webp/Assets/FlangoFruitLogo.webp" alt="Flango Logo"></button>
            </div>
        </div>
        <div id="user-session-banner" class="user-session-banner">
            <div id="logged-in-user"></div>
        </div>
        <div id="products-area">
            <div id="cafe-event-strip"></div>
            <div id="product-reorder-hint" class="product-reorder-hint">
              Tr√¶k i produkter for at √¶ndre placering. Tryk ENTER for at forts√¶tte.
            </div>
            <div id="products"></div> <!-- Vare-knapperne vises her -->
        </div>
        <div id="sidebar">
            <div id="toolbar-gear-menu" class="toolbar-gear-menu" style="display:none;"></div>
            <div class="sidebar-header">
                <h2>Indk√∏bskurv</h2>
                <img src="Icons/webp/Function/Kurv.webp" alt="Indk√∏bskurv" class="sidebar-header-icon">
            </div>
            <div id="current-order">
                <ul id="order-list"></ul>
            </div>

            <!-- Selected User Info Box - Shows selected customer details -->
            <div id="selected-user-info" style="display: none;"></div>

            <div id="checkout-stack">
                <div id="total-price">Total: 0,00 DKK</div>
                <div id="user-selection-area">
                    <div id="user-selection-actions">
                        <button id="select-customer-main-btn">V√¶lg Kunde</button>
                        <button id="complete-purchase" class="action-button cafe-btn">
                            <span>Gennemf√∏r K√∏b</span>
                        </button>
                    </div>
                    <button id="cafe-mode-btn" class="action-button" style="background-color: var(--success-color); display: none;">Start Caf√©-tilstand ‚òï</button>
                </div>
                <div id="bottom-buttons">
                    <div class="flango-cafe-grid">
                        <div id="admin-panel" style="display: none;">
                            <button id="edit-menu-original-btn" class="action-button admin-btn cafe-btn" style="display: none;">
                                <span>Rediger Menu ‚úèÔ∏è</span>
                            </button>
                        </div>
                        <button id="sales-history-btn" class="action-button admin-btn cafe-btn" style="display: none;">
                            <span>Historik üìú</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="login-modal" class="modal"></div>
    <div id="user-modal" class="modal"></div>
    <div id="admin-user-manager-modal" class="modal"></div>
    <div id="avatar-picker-modal" class="modal"></div>
    <div id="add-edit-product-modal" class="modal"></div>
    <div id="quick-login-modal" class="modal"></div>
    <div id="add-edit-user-modal" class="modal"></div>
    <div id="balance-modal" class="modal"></div>
    <div id="edit-user-detail-modal" class="modal"></div>
    <div id="assign-badge-modal" class="modal"></div>
    <div id="event-admin-modal" class="modal"></div>
    <div id="db-history-modal" class="modal"></div>
    <div id="auto-import-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 520px;">
            <div class="modal-header">
                <h2>Opret / opdater brugere automatisk</h2>
                <span class="close-btn" id="auto-import-close-btn">&times;</span>
            </div>
            <p>
                Upload en CSV- eller Excel-fil med brugere.<br>
                Flango hj√¶lper dig senere med at matche felter til kontonummer, navn og saldo.
            </p>
            <div id="auto-import-step-1">
                <label for="auto-import-file-input" class="flango-label">Upload dokument</label>
                <input id="auto-import-file-input" type="file" accept=".csv,.xlsx,.xls">
                <div id="auto-import-error" class="assign-badge-note" style="display:none; color: var(--danger-color); margin-top:6px;"></div>
            </div>
            <div id="auto-import-step-2" style="display:none;">
                <p>Filen er modtaget. N√¶ste skridt bliver at matche kolonner til kontonummer, navn og saldo.</p>
                <p id="auto-import-selected-file-name"></p>
                <div id="auto-import-summary" class="auto-import-summary"></div>
                <div id="auto-import-mapping">
                    <p>V√¶lg hvilke kolonner der svarer til kontonummer, navn og saldo:</p>
                    <div class="auto-import-mapping-row">
                        <label for="auto-import-field-number">Kontonummer / brugernummer</label>
                        <select id="auto-import-field-number"></select>
                    </div>
                    <div class="auto-import-mapping-row">
                        <label for="auto-import-field-name">Navn</label>
                        <select id="auto-import-field-name"></select>
                    </div>
                    <div class="auto-import-mapping-row">
                        <label for="auto-import-field-balance">Saldo</label>
                        <select id="auto-import-field-balance"></select>
                    </div>
                    <div class="auto-import-mapping-row">
                        <label for="auto-import-field-grade">Klasse (valgfrit)</label>
                        <select id="auto-import-field-grade"><option value="">(Ingen)</option></select>
                    </div>
                    <div id="auto-import-preview" class="auto-import-preview"></div>
                </div>
            </div>
            <div class="modal-actions" style="margin-top: 12px;">
                <button id="auto-import-cancel-btn" class="action-button admin-btn secondary-action">Annuller</button>
                <button id="auto-import-continue-btn" class="action-button admin-btn">Forts√¶t</button>
            </div>
        </div>
    </div>
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>Rediger Menu</h2><span class="close-btn">&times;</span></div><div id="modal-product-list" class="modal-product-list"></div><button id="add-btn-modal" class="add-product-btn">‚ûï Tilf√∏j Nyt Produkt</button></div>
    </div>
    <div id="sales-history-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2>Transaktionshistorik</h2><span class="close-btn">&times;</span></div>
            <div class="report-buttons">
                <button id="toolbar-summary-btn" class="action-button" style="background-color: var(--primary-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0;">üìä Opsummering</button>
                <button id="history-filter-btn" class="action-button btn-filter" style="padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Filter</button>
                <button id="filter-deposits-btn" class="action-button" style="background-color: var(--secondary-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Vis Kun Indbetalinger</button>
                <button id="print-negative-balance-btn" class="action-button" style="background-color: var(--warning-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Gem Negativ Saldo</button>
                <button id="print-report-btn" class="action-button" style="background-color: var(--success-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Gem Rapport</button>
                <button id="print-all-balances-btn" class="action-button btn-all-balances" style="padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Gem liste med alle saldoer</button>
                <button id="history-undo-last-sale-btn" class="action-button btn-undo-last-sale" style="padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Fortryd Sidste Salg</button>
            </div>
            <div id="history-filter-panel" class="history-filter-panel" style="display: none;">
                <div class="filter-actions">
                    <button id="history-filter-deselect-all" class="action-button secondary-action">Frav√¶lg alle</button>
                    <button id="history-filter-select-all" class="action-button secondary-action">V√¶lg alle</button>
                </div>
                <div class="filter-options">
                    <div class="filter-column">
                        <label><input type="checkbox" class="history-filter-checkbox" value="SALE" checked> Salg</label>
                        <label><input type="checkbox" class="history-filter-checkbox" value="DEPOSIT" checked> Indbetalinger</label>
                        <label><input type="checkbox" class="history-filter-checkbox" value="BALANCE_ADJUSTMENT" checked> Saldo Rettelser</label>
                        <label><input type="checkbox" class="history-filter-checkbox" value="SALE_EDIT" checked> Redigerede Salg</label>
                        <label><input type="checkbox" class="history-filter-checkbox" value="SALE_UNDO" checked> Fortrudte Salg</label>
                    </div>
                </div>
            </div>
            <div class="date-filter">
                <input type="date" id="history-start-date" autocomplete="off" spellcheck="false" autocapitalize="off">
                <span>til</span>
                <input type="date" id="history-end-date" autocomplete="off" spellcheck="false" autocapitalize="off">
            </div>
            <div class="modal-controls" style="padding-top: 15px;">
                <input type="text" id="search-history-input" placeholder="S√∏g efter navn eller nummer..." autocomplete="off" spellcheck="false" autocapitalize="off">
            </div>
            <div class="history-scroll-container">
                <div id="sales-summary"></div>
                <div id="sales-history-list" class="modal-user-list"></div>
            </div>
        </div>
    </div>

    <div id="assortment-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header"><h2>Dagens Sortiment</h2><span class="close-btn">&times;</span></div>
            <div class="modal-user-list">
                <div id="assortment-settings" class="settings-section">
                    <h3>Tr√¶k for at sortere</h3>
                    <div id="assortment-list"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="sound-settings-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header"><h2>Lydindstillinger</h2><span class="close-btn">&times;</span></div>
            <div class="modal-user-list">
                <div id="sound-settings" class="settings-section">
                    <h3>V√¶lg lyde</h3>
                    <div id="sound-options-list"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sukkerpolitik Modal (separat) -->
    <div id="sugar-policy-settings-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px; width: 95%;">
            <div class="modal-header">
                <h2>üç¨ Sukkerpolitik</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-user-list" style="padding: 20px;">
                <div class="toggle-row" style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
                    <input type="checkbox" id="sugar-policy-enabled-toggle" style="width: 20px; height: 20px; cursor: pointer;">
                    <span id="sugar-policy-enabled-label" style="font-weight: 600; font-size: 16px;">Sukkerpolitik er sl√•et FRA</span>
                </div>
                <div id="sugar-policy-settings" class="sugar-policy-settings-row" style="padding-top: 15px; border-top: 1px solid #eee;">
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <label class="sugar-policy-max-row" style="display: block; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                            <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                <input type="checkbox" id="sugar-policy-max-per-product-enabled" style="margin-right: 10px; cursor: pointer; width: 18px; height: 18px;">
                                <strong style="cursor: pointer; font-size: 14px;">Maks af hver usund vare/dag</strong>
                            </div>
                            <input type="number" id="sugar-policy-max-per-product" min="0" step="1" placeholder="1" style="width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px;">
                        </label>
                        <label class="sugar-policy-max-row" style="display: block; padding: 12px; background: #f8f9fa; border-radius: 8px;">
                            <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                <input type="checkbox" id="sugar-policy-max-unhealthy-enabled" style="margin-right: 10px; cursor: pointer; width: 18px; height: 18px;">
                                <strong style="cursor: pointer; font-size: 14px;">Maks usunde produkter/dag</strong>
                            </div>
                            <input type="number" id="sugar-policy-max-unhealthy" min="0" step="1" placeholder="2" style="width: 100%; padding: 8px 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px;">
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px; justify-content: space-between;">
                <button id="back-to-preferences-sugar-settings-btn" style="padding: 10px 20px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
                <button id="apply-sugar-settings-btn" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Gem indstillinger</button>
            </div>
        </div>
    </div>

    <!-- Regler for produkter Modal (uden sukkerpolitik) -->
    <div id="sugar-policy-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 900px; width: 95%;">
            <div class="modal-header">
                <h2>Produktoversigt</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-user-list" style="padding: 15px;">
                <!-- Product Rules Table -->
                <div class="settings-section">
                    <h3 id="product-overview-subtitle" style="margin: 0 0 12px 0; font-size: 15px;">Tilf√∏j/Rediger produkter</h3>
                    <div id="product-rules-table-container" style="overflow-x: auto; max-height: 60vh; overflow-y: auto;">
                        <table id="product-rules-table" style="width: 100%; border-collapse: collapse; font-size: 13px;">
                            <thead style="position: sticky; top: 0; z-index: 10;">
                                <tr style="background: #f5f5f5; border-bottom: 2px solid #ddd;">
                                    <th style="padding: 10px 8px; text-align: left; font-weight: 600; background: #f5f5f5;">Ikon</th>
                                    <th class="sortable-col" data-sort="name" style="padding: 10px 8px; text-align: left; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Navn <span class="sort-indicator"></span></th>
                                    <th class="sortable-col" data-sort="price" style="padding: 10px 8px; text-align: center; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Pris <span class="sort-indicator"></span></th>
                                    <th class="sortable-col" data-sort="limit" style="padding: 10px 8px; text-align: center; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Gr√¶nse <span class="sort-indicator"></span></th>
                                    <th class="sortable-col" data-sort="daily_special" style="padding: 10px 8px; text-align: center; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Dagens ret <span class="sort-indicator"></span></th>
                                    <th class="sortable-col" data-sort="core_assortment" style="padding: 10px 8px; text-align: center; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Fast sort. <span class="sort-indicator"></span></th>
                                    <th class="sortable-col" data-sort="in_assortment" style="padding: 10px 8px; text-align: center; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Dagens sort. <span class="sort-indicator"></span></th>
                                    <th class="sortable-col" data-sort="unhealthy" id="col-unhealthy" style="padding: 10px 8px; text-align: center; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Usund <span class="sort-indicator"></span></th>
                                    <th class="sortable-col" data-sort="active" style="padding: 10px 8px; text-align: center; font-weight: 600; cursor: pointer; user-select: none; background: #f5f5f5;">Aktiv <span class="sort-indicator"></span></th>
                                    <th style="padding: 10px 8px; text-align: center; font-weight: 600; background: #f5f5f5;">Slet</th>
                                    <th style="padding: 10px 8px; text-align: center; font-weight: 600; background: #f5f5f5;">Rediger</th>
                                </tr>
                            </thead>
                            <tbody id="product-rules-tbody">
                                <!-- Produktr√¶kker inds√¶ttes her af JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <div id="product-rules-empty" style="display: none; text-align: center; padding: 30px; color: #666;">
                        Ingen produkter fundet. Tilf√∏j produkter under "Rediger Menu".
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px; justify-content: space-between; align-items: center;">
                <button id="back-to-preferences-sugar-policy-btn" style="padding: 10px 20px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button id="toggle-inactive-products-btn" style="padding: 10px 16px; background: #f5f5f5; color: #666; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; font-weight: 500;">Vis deaktiverede</button>
                    <button id="add-product-from-rules-btn" style="padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">+ Tilf√∏j nyt produkt</button>
                </div>
                <button id="apply-sugar-policy-btn" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Anvend √¶ndringer</button>
            </div>
        </div>
    </div>

    <div id="spending-limit-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Bel√∏bsgr√¶nse</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-user-list">
                <!-- Spending Limit Section -->
                <div class="settings-section">
                    <h3>Daglig Forbrugsgr√¶nse</h3>
                    <div class="toggle-row">
                        <span id="spending-limit-enabled-label">Forbrugsgr√¶nse er sl√•et FRA</span>
                        <input type="checkbox" id="spending-limit-enabled-toggle">
                    </div>
                    <div id="spending-limit-settings" style="margin-top: 15px; display: none;">
                        <label style="display: block; margin-bottom: 10px;">
                            <strong>Maksimalt forbrug per dag:</strong>
                            <input type="number" id="spending-limit-amount" min="0" step="1" placeholder="40" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px;">
                            <div style="font-size: 12px; color: #666; margin-top: 3px;">Bel√∏b i kr. (fx 40)</div>
                        </label>
                        <div style="margin-top: 15px;">
                            <strong>G√¶lder for:</strong>
                            <label style="display: block; margin-top: 8px; cursor: pointer;">
                                <input type="checkbox" id="spending-limit-regular-users" checked style="margin-right: 8px;">
                                Almindelige brugere
                            </label>
                            <label style="display: block; margin-top: 8px; cursor: pointer;">
                                <input type="checkbox" id="spending-limit-admins" style="margin-right: 8px;">
                                Admins
                            </label>
                            <label style="display: block; margin-top: 8px; cursor: pointer;">
                                <input type="checkbox" id="spending-limit-test-users" style="margin-right: 8px;">
                                Testbrugere
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Balance Limit Section -->
                <div class="settings-section" style="margin-top: 20px;">
                    <h3>Saldogr√¶nse</h3>
                    <div class="toggle-row">
                        <span id="balance-limit-enabled-label">Saldogr√¶nse er sl√•et TIL</span>
                        <input type="checkbox" id="balance-limit-enabled-toggle" checked>
                    </div>
                    <div id="balance-limit-settings" style="margin-top: 15px;">
                        <label style="display: block; margin-bottom: 10px;">
                            <strong>Saldogr√¶nse:</strong>
                            <input type="number" id="balance-limit-amount" step="1" placeholder="-10" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px;">
                            <div style="font-size: 12px; color: #666; margin-top: 3px;">Saldoer kan ikke komme under det valgte bel√∏b. K√∏b som overstiger saldogr√¶nsen blokeres.</div>
                        </label>
                        <div style="margin-top: 15px;">
                            <strong>Undtagelser:</strong>
                            <label style="display: block; margin-top: 8px; cursor: pointer;">
                                <input type="checkbox" id="balance-limit-exempt-admins" style="margin-right: 8px;">
                                Ingen saldogr√¶nse for admins
                            </label>
                            <label style="display: block; margin-top: 8px; cursor: pointer;">
                                <input type="checkbox" id="balance-limit-exempt-test-users" style="margin-right: 8px;">
                                Ingen saldogr√¶nse for test-brugere
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="padding: 15px; border-top: 1px solid #eee; display: flex; gap: 10px; justify-content: space-between;">
                <button id="back-to-preferences-spending-limit-btn" style="padding: 10px 20px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
                <button id="save-spending-limit-btn" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">Gem</button>
            </div>
        </div>
    </div>

    <!-- Parent Portal Settings Menu (3-button menu) -->
    <div id="parent-portal-settings-modal" class="settings-modal-backdrop" style="display: none;">
        <div class="settings-modal" style="max-width: 600px;">
            <h2 id="parent-portal-settings-title">For√¶ldreportalen</h2>
            <div id="parent-portal-settings-content" class="settings-modal-content">
                <button id="parent-portal-payment-methods-btn" class="settings-item-btn">
                    <strong>Optankning / Betalingsmetoder</strong>
                    <div style="font-size: 12px; margin-top: 2px;">Konfigurer hvordan for√¶ldre kan indbetale</div>
                </button>
                <button id="parent-portal-features-btn" class="settings-item-btn">
                    <strong>Aktive funktioner p√• for√¶ldreportalen</strong>
                    <div style="font-size: 12px; margin-top: 2px;">V√¶lg hvilke funktioner for√¶ldre kan bruge</div>
                </button>
                <button id="parent-portal-codes-menu-btn" class="settings-item-btn">
                    <strong>For√¶ldreportal-koder</strong>
                    <div style="font-size: 12px; margin-top: 2px;">Administrer adgangskoder til for√¶ldreportalen</div>
                </button>
            </div>
            <div class="settings-modal-actions">
                <button id="back-to-preferences-parent-portal-btn" class="settings-button">‚Üê Tilbage</button>
                <button id="parent-portal-settings-close" class="settings-button">Luk</button>
            </div>
        </div>
    </div>

    <!-- Modal #1: Optankning / Betalingsmetoder -->
    <div id="parent-portal-payment-methods-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 700px; max-height: 90vh;">
            <div class="modal-header">
                <h2>Optankning / Betalingsmetoder</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-user-list" style="padding: 20px;">
                <p style="font-size: 14px; color: #666; margin-bottom: 20px; line-height: 1.5;">
                    Kommuner og institutioner har forskellige aftaler med betalingsudbydere. Her kan I v√¶lge de metoder, der passer bedst til jeres institution. Kontakt skolens sekret√¶r eller kommunens √∏konomiafdeling, hvis I er i tvivl om, hvilke aftaler I har adgang til.
                </p>
                <div id="payment-admin-fee-section" style="margin-bottom: 24px; padding: 16px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <div style="font-size: 14px; font-weight: 600; margin-bottom: 6px;">Administrationsomkostning ved indbetaling</div>
                    <div style="font-size: 12px; color: #666; margin-bottom: 12px;">Den valgte bestemmer, hvordan priser beregnes p√• for√¶ldreportalen ved indbetalinger.</div>
                    <div class="fee-policy-radio" style="display: flex; flex-direction: column; gap: 10px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 14px;">
                            <input type="radio" name="admin-fee-payer" value="institution" style="width: 18px; height: 18px; cursor: pointer;">
                            <span>Institutionen betaler administrationsomkostningen</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 14px;">
                            <input type="radio" name="admin-fee-payer" value="parent" style="width: 18px; height: 18px; cursor: pointer;">
                            <span>For√¶ldre betaler administrationsomkostningen (vises tydeligt ved betaling)</span>
                        </label>
                    </div>
                </div>
                <div id="payment-methods-list"></div>
                <div id="payment-methods-warnings" style="margin-top: 20px;"></div>
                <div style="padding: 20px 0 0 0; display: flex; justify-content: space-between; gap: 10px;">
                    <button id="back-to-parent-portal-menu-btn" style="padding: 12px 40px; font-size: 16px; background: #666; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
                    <button id="save-payment-methods-btn" class="btn-primary" style="padding: 12px 40px; font-size: 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer;">GEM</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal #2: Aktive funktioner p√• for√¶ldreportalen -->
    <div id="parent-portal-features-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>Aktive funktioner p√• for√¶ldreportalen</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-user-list" style="padding: 20px;">
                <div class="settings-section">
                    <div style="padding: 15px;">
                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: pointer;">
                            <input type="checkbox" id="parent-portal-email-notifications" style="margin-right: 12px; cursor: pointer;" checked>
                            <div>
                                <strong>F√• saldo notifikationer p√• e-mail</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre modtager e-mail n√•r saldo er lav</div>
                            </div>
                        </label>

                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: pointer;">
                            <input type="checkbox" id="parent-portal-spending-limit" style="margin-right: 12px; cursor: pointer;" checked>
                            <div>
                                <strong>Daglig Bel√∏bsgr√¶nse</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre kan s√¶tte daglig forbrugsgr√¶nse for deres barn</div>
                            </div>
                        </label>

                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: pointer;">
                            <input type="checkbox" id="parent-portal-allergens" style="margin-right: 12px; cursor: pointer;" checked>
                            <div>
                                <strong>Allergener</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre kan v√¶lge allergener for deres barn</div>
                            </div>
                        </label>

                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: pointer;">
                            <input type="checkbox" id="parent-portal-product-limit" style="margin-right: 12px; cursor: pointer;">
                            <div>
                                <strong>K√∏bsgr√¶nse pr produkt</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre kan begr√¶nse antal af specifikke produkter per dag</div>
                            </div>
                        </label>

                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: pointer;">
                            <input type="checkbox" id="parent-portal-sugar-policy" style="margin-right: 12px; cursor: pointer;">
                            <div>
                                <strong>Sukkerpolitik</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre kan begr√¶nse usunde produkter for deres barn</div>
                            </div>
                        </label>
                    </div>

                    <h4 style="margin: 0 15px 10px; color: #999; font-size: 13px; font-weight: 500;">Kommer snart</h4>
                    <div style="padding: 0 15px 15px; opacity: 0.5;">
                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: not-allowed;">
                            <input type="checkbox" id="parent-portal-vegetarian-only" style="margin-right: 12px;" disabled>
                            <div>
                                <strong>Kun Vegetarisk</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre kan markere at deres barn kun m√• k√∏be vegetariske produkter</div>
                            </div>
                        </label>

                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: not-allowed;">
                            <input type="checkbox" id="parent-portal-no-pork" style="margin-right: 12px;" disabled>
                            <div>
                                <strong>M√• ikke f√• svinek√∏d</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre kan markere at deres barn ikke m√• f√• svinek√∏d</div>
                            </div>
                        </label>

                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: not-allowed;">
                            <input type="checkbox" id="parent-portal-no-unhealthy" style="margin-right: 12px;" disabled>
                            <div>
                                <strong>M√• ikke k√∏be noget usundt</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">For√¶ldre kan blokere alle usunde produkter for deres barn</div>
                            </div>
                        </label>
                    </div>
                </div>
                <div style="padding: 20px 0 0 0; display: flex; justify-content: space-between; gap: 10px;">
                    <button id="back-to-parent-portal-menu-features-btn" style="padding: 12px 40px; font-size: 16px; background: #666; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
                    <button id="save-parent-portal-features-btn" class="btn-primary" style="padding: 12px 40px; font-size: 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer;">GEM</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Stripe Onboarding Modal -->
    <div id="stripe-onboarding-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Stripe Connect Ops√¶tning</h2>
                <span class="close-btn" id="stripe-onboarding-close">&times;</span>
            </div>
            <div class="modal-user-list" style="padding: 20px;">
                <p style="font-size: 14px; color: #666; margin-bottom: 20px; line-height: 1.5;">
                    V√¶lg om I vil bruge test- eller live-mode til Stripe Connect. Test-mode anbefales til at starte med.
                </p>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; font-size: 14px;">
                        V√¶lg mode:
                    </label>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <label class="stripe-mode-option" style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; transition: all 0.2s;">
                            <input type="radio" name="stripe-mode" value="test" checked style="cursor: pointer;">
                            <div>
                                <div class="font-weight-600" style="font-weight: 600;">Test mode</div>
                                <div style="font-size: 12px; color: #666;">Anbefalet til at starte med. Ingen rigtige betalinger.</div>
                            </div>
                        </label>
                        <label class="stripe-mode-option" style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; transition: all 0.2s;">
                            <input type="radio" name="stripe-mode" value="live" style="cursor: pointer;">
                            <div>
                                <div class="font-weight-600" style="font-weight: 600;">Live mode</div>
                                <div style="font-size: 12px; color: #666;">Rigtige betalinger. Kr√¶ver fuld verifikation.</div>
                            </div>
                        </label>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; gap: 10px; margin-top: 20px;">
                    <button id="stripe-onboarding-cancel" style="padding: 12px 24px; font-size: 16px; background: #666; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">Annuller</button>
                    <button id="stripe-onboarding-save" class="btn-primary" style="padding: 12px 24px; font-size: 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer;">Start ops√¶tning</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal #3: For√¶ldreportal-koder -->
    <div id="parent-portal-codes-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>For√¶ldreportal-koder</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-user-list" style="padding: 20px;">
                <div id="parent-portal-codes-content">
                    <p style="font-size: 14px; color: #666; margin-bottom: 20px;">
                        Her kan I administrere adgangskoder til for√¶ldreportalen. Hver familie f√•r en unik kode, som de bruger til at logge ind.
                    </p>
                    <button id="parent-portal-codes-admin-btn" class="settings-item-btn" style="width: 100%; margin-bottom: 15px;">
                        <strong>Administrer For√¶ldreportal-koder</strong>
                        <div style="font-size: 12px; margin-top: 2px;">√Öbn administrationsvinduet for at se og administrere alle koder</div>
                    </button>
                </div>
                <div style="padding: 20px 0 0 0; display: flex; justify-content: flex-start;">
                    <button id="back-to-parent-portal-menu-codes-btn" style="padding: 12px 40px; font-size: 16px; background: #666; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
                </div>
            </div>
        </div>
    </div>

    <div id="admin-rules-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Admin Regler</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="modal-user-list">
                <div class="settings-section">
                    <h3>Administrator indstillinger</h3>
                    <div style="padding: 15px;">
                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: pointer;">
                            <input type="checkbox" id="admin-rules-show-admins-checkbox" style="margin-right: 12px; cursor: pointer;">
                            <div>
                                <strong>Vis Admins i 'V√¶lg Bruger' listen</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">Voksne kan v√¶lges som kunder i caf√©en</div>
                            </div>
                        </label>

                        <label style="display: flex; align-items: center; margin-bottom: 15px; cursor: pointer;">
                            <input type="checkbox" id="admin-rules-admins-free-checkbox" style="margin-right: 12px; cursor: pointer;">
                            <div>
                                <strong>Admins skal ikke betale</strong>
                                <div style="font-size: 12px; color: #666; margin-top: 3px;">Voksne k√∏ber for 0 kr (registreres stadig i historik)</div>
                            </div>
                        </label>
                    </div>
                </div>

                <div style="padding: 20px; display: flex; justify-content: space-between; gap: 10px;">
                    <button id="back-to-preferences-admin-rules-btn" style="padding: 12px 40px; font-size: 16px; background: #666; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
                    <button id="save-admin-rules-btn" class="btn-primary" style="padding: 12px 40px; font-size: 16px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer;">GEM</button>
                </div>
            </div>
        </div>
    </div>

    <div id="custom-alert-modal" class="modal">
        <div id="custom-alert-content">
            <h2 id="custom-alert-title">Bekr√¶ft K√∏b</h2>
            <p id="custom-alert-body"></p>
            <div id="custom-alert-buttons">
                <button id="custom-alert-ok">OK</button>
                <button id="custom-alert-cancel">Annuller</button>
            </div>
        </div>
    </div>

    <div id="pin-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; height: auto;">
            <div class="modal-header">
                <h2 id="pin-modal-title">Indtast PIN</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div id="pin-display"></div>
            <div id="pin-keypad">
                <button class="keypad-btn" data-key="1">1</button>
                <button class="keypad-btn" data-key="2">2</button>
                <button class="keypad-btn" data-key="3">3</button>
                <button class="keypad-btn" data-key="4">4</button>
                <button class="keypad-btn" data-key="5">5</button>
                <button class="keypad-btn" data-key="6">6</button>
                <button class="keypad-btn" data-key="7">7</button>
                <button class="keypad-btn" data-key="8">8</button>
                <button class="keypad-btn" data-key="9">9</button>
                <button class="keypad-btn keypad-action" data-key="clear">C</button>
                <button class="keypad-btn" data-key="0">0</button>
                <button class="keypad-btn keypad-action" data-key="backspace">‚å´</button>
            </div>
            <div id="pin-modal-buttons" style="display: flex; gap: 15px; margin-top: 20px; justify-content: center;">
                <button id="pin-modal-ok-btn" class="action-button" style="flex: 1; max-width: 200px;">OK</button>
            </div>
        </div>
    </div>

    <!-- Summary/Opsummering Modal -->
    <div id="summary-modal" class="modal">
        <div class="modal-content" style="max-width: 1200px; height: 90%;">
            <div class="modal-header">
                <h2>üìä Opsummering</h2>
                <span class="close-btn">&times;</span>
            </div>

            <!-- View Mode Selector -->
            <div class="summary-view-selector">
                <button class="summary-view-btn active" data-view="overview">üìä Oversigt</button>
                <button class="summary-view-btn" data-view="transactions">üì¶ Transaktioner</button>
                <button class="summary-view-btn" data-view="period">üìÖ Periodevisning</button>
                <button class="summary-view-btn" data-view="employee">üë• Personale</button>
                <button class="summary-view-btn" data-view="purchase-profiles">üìà K√∏bsprofiler</button>
                <button class="summary-view-btn admin-only-view" data-view="statistics">üìã Statistik</button>
            </div>

            <!-- Period Segmented Control (only visible in period view) -->
            <div id="period-segment-control" class="period-segment-control" style="display: none;">
                <div class="segment-group">
                    <button class="segment-btn active" data-period="day">
                        <span class="segment-icon">üìÖ</span>
                        <span class="segment-label">Dag</span>
                    </button>
                    <button class="segment-btn" data-period="week">
                        <span class="segment-icon">üìÜ</span>
                        <span class="segment-label">Uge</span>
                    </button>
                    <button class="segment-btn" data-period="month">
                        <span class="segment-icon">üóìÔ∏è</span>
                        <span class="segment-label">M√•ned</span>
                    </button>
                    <button class="segment-btn" data-period="year">
                        <span class="segment-icon">üìä</span>
                        <span class="segment-label">√Ör</span>
                    </button>
                </div>
            </div>

            <!-- Employee Role Selector (only visible in employee view) -->
            <div id="employee-role-selector" class="summary-view-selector" style="display: none; margin-top: 10px; border-top: 1px solid var(--border-color, #e0e0e0); padding-top: 10px;">
                <button class="summary-role-btn active" data-role="admin">üë®‚Äçüíº Voksne</button>
                <button class="summary-role-btn" data-role="kunde">üë¶ B√∏rn</button>
            </div>

            <!-- Delt Filter/Dato sektion for Oversigt og Transaktioner -->
            <div id="shared-history-controls" style="display: none;">
                <div class="report-buttons" style="display: flex; flex-wrap: wrap; gap: 8px; align-items: center;">
                    <button id="history-filter-btn-shared" class="action-button btn-filter" style="padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Filter</button>
                    <button id="filter-deposits-btn-shared" class="action-button" style="background-color: var(--secondary-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Vis Kun Indbetalinger</button>
                    <button id="select-user-history-btn-shared" class="action-button" style="background-color: var(--primary-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0; white-space: nowrap;">üë§ V√¶lg Bruger</button>
                    <span id="selected-user-badge-shared" style="display: none; padding: 8px 12px; font-size: 14px; background-color: #e0e7ff; color: #3730a3; border-radius: 6px; white-space: nowrap;">
                        <span id="selected-user-name-shared"></span>
                        <button id="clear-user-filter-btn-shared" style="margin-left: 8px; background: none; border: none; color: #3730a3; cursor: pointer; font-size: 16px; font-weight: bold; padding: 0;">√ó</button>
                    </span>
                    <button id="print-negative-balance-btn-shared" class="action-button" style="background-color: var(--warning-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Gem Negativ Saldo</button>
                    <button id="print-report-btn-shared" class="action-button" style="background-color: var(--success-color); padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Gem Rapport</button>
                    <button id="print-all-balances-btn-shared" class="action-button btn-all-balances" style="padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Gem liste med alle saldoer</button>
                    <button id="history-undo-last-sale-btn-shared" class="action-button btn-undo-last-sale" style="padding: 8px 12px; font-size: 14px; margin-bottom: 0;">Fortryd Sidste Salg</button>
                </div>
                <div id="history-filter-panel-shared" class="history-filter-panel" style="display: none;">
                    <div class="filter-actions">
                        <button id="history-filter-deselect-all-shared" class="action-button secondary-action">Frav√¶lg alle</button>
                        <button id="history-filter-select-all-shared" class="action-button secondary-action">V√¶lg alle</button>
                    </div>
                    <div class="filter-options">
                        <div class="filter-column">
                            <label><input type="checkbox" class="history-filter-checkbox-shared" value="SALE" checked> Salg</label>
                            <label><input type="checkbox" class="history-filter-checkbox-shared" value="DEPOSIT" checked> Indbetalinger</label>
                            <label><input type="checkbox" class="history-filter-checkbox-shared" value="BALANCE_ADJUSTMENT" checked> Saldo Rettelser</label>
                            <label><input type="checkbox" class="history-filter-checkbox-shared" value="SALE_EDIT" checked> Redigerede Salg</label>
                            <label><input type="checkbox" class="history-filter-checkbox-shared" value="SALE_UNDO" checked> Fortrudte Salg</label>
                        </div>
                    </div>
                </div>
                <div class="date-filter">
                    <input type="date" id="history-start-date-shared" autocomplete="off" spellcheck="false" autocapitalize="off">
                    <span>til</span>
                    <input type="date" id="history-end-date-shared" autocomplete="off" spellcheck="false" autocapitalize="off">
                </div>
                <div class="modal-controls" style="padding-top: 15px;">
                    <input type="text" id="search-history-input-shared" placeholder="S√∏g efter navn eller nummer..." autocomplete="off" spellcheck="false" autocapitalize="off">
                </div>
            </div>

            <!-- Overview View (when Oversigt is selected) - viser kun opsummering og diagram -->
            <div id="overview-view-container" class="summary-view-content" style="display: none;">
                <div class="history-scroll-container">
                    <div id="sales-summary-overview"></div>
                </div>
            </div>

            <!-- Transactions View (when Transaktioner is selected) - viser kun posteringsliste -->
            <div id="transactions-view-container" class="summary-view-content" style="display: none;">
                <div class="history-scroll-container">
                    <div id="sales-summary-transactions"></div>
                    <div id="sales-history-list-summary" class="modal-user-list"></div>
                </div>
            </div>

            <!-- Summary Table View (when Dag/Uge/M√•ned/√Ör/Personale is selected) -->
            <div id="summary-table-view-container" class="summary-view-content" style="display: none;">
                <!-- Date Range Filter -->
                <div class="summary-filters">
                    <div class="filter-group">
                        <label for="summary-from-date">Fra dato:</label>
                        <input type="date" id="summary-from-date" class="date-input">
                    </div>
                    <div class="filter-group">
                        <label for="summary-to-date">Til dato:</label>
                        <input type="date" id="summary-to-date" class="date-input">
                    </div>
                    <button id="summary-apply-filter" class="action-button">Anvend Filter</button>
                    <button id="summary-reset-filter" class="action-button secondary-action">Nulstil</button>
                </div>

                <!-- Test Users Toggle -->
                <div style="margin: 16px 0; padding-top: 16px; border-top: 1px solid var(--border-color, #e0e0e0);">
                    <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 14px;">
                            <input type="checkbox" id="summary-show-test-users-checkbox" style="cursor: pointer;">
                            <span>Vis testbrugere (Snoop Dog, Test Aladin)</span>
                        </label>
                        <button id="summary-only-test-users-btn" class="action-button secondary-action" style="font-size: 12px; padding: 6px 12px;">
                            Vis KUN testbrugere
                        </button>
                    </div>
                </div>

                <!-- Table Container -->
                <div id="summary-table-container" class="summary-table-container">
                    <!-- Table will be dynamically rendered here -->
                </div>

                <!-- Loading & Error States -->
                <div id="summary-loading" class="summary-loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>Indl√¶ser data...</p>
                </div>
                <div id="summary-error" class="summary-error" style="display: none;">
                    <p>‚ö†Ô∏è Fejl ved indl√¶sning af data</p>
                    <p id="summary-error-message"></p>
                </div>

                <!-- Export Buttons -->
                <div class="summary-actions">
                    <button id="summary-export-csv" class="action-button">üìÑ Eksporter til CSV</button>
                    <button id="summary-export-pdf" class="action-button secondary-action" style="display: none;">üìë Eksporter til PDF</button>
                </div>
            </div>

            <!-- Purchase Profiles View (K√∏bsprofiler) -->
            <div id="purchase-profiles-view-container" class="summary-view-content" style="display: none;">
                <div class="purchase-profiles-content">
                    <!-- Compact Top Bar with User Dropdown -->
                    <div class="purchase-profiles-top-bar">
                        <div class="purchase-profiles-user-select-wrapper">
                            <select id="purchase-profiles-user-select" class="purchase-profiles-user-select">
                                <option value="">V√¶lg bruger...</option>
                            </select>
                        </div>
                        <div class="purchase-profiles-period-wrapper">
                            <label for="purchase-profiles-period-select">Periode:</label>
                            <select id="purchase-profiles-period-select" class="purchase-profiles-period-select">
                                <option value="all" selected>Alle</option>
                                <option value="30">30 dage</option>
                                <option value="7">7 dage</option>
                            </select>
                        </div>
                        <div class="purchase-profiles-total-wrapper">
                            <span class="purchase-profiles-total-label">Totalforbrug:</span>
                            <span id="purchase-profiles-total-amount" class="purchase-profiles-total-amount">0,00 kr</span>
                        </div>
                    </div>

                    <!-- Chart Section (always visible, shows empty state or chart) -->
                    <div id="purchase-profiles-chart-section" class="purchase-profiles-chart-section">
                        <!-- Chart Title with Sort Toggle -->
                        <div class="purchase-profiles-chart-header">
                            <h4>Mest k√∏bte produkter</h4>
                            <div class="purchase-profiles-sort-toggle">
                                <span>Sorter efter:</span>
                                <button id="purchase-profiles-sort-antal" class="purchase-profiles-sort-btn active" data-sort="antal">ANTAL</button>
                                <span>/</span>
                                <button id="purchase-profiles-sort-kr" class="purchase-profiles-sort-btn" data-sort="kr">KR</button>
                            </div>
                        </div>

                        <!-- The 3D Bar Chart -->
                        <div id="purchase-profiles-chart" class="purchase-profiles-chart">
                            <!-- Bars will be rendered here -->
                        </div>

                        <!-- Empty/Initial State -->
                        <div id="purchase-profiles-empty" class="purchase-profiles-empty">
                            <p>V√¶lg en bruger for at se k√∏bsprofil</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Statistics View (Statistik - Admin Only) -->
            <div id="statistics-view-container" class="summary-view-content" style="display: none;">
                <!-- Content rendered by statistics-ui.js -->
            </div>
        </div>
    </div>

    <!-- Andre varer Modal (for Purchase Profiles) -->
    <div id="andre-varer-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px; height: auto;">
            <div class="modal-header">
                <h2>Andre varer</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div id="andre-varer-list" class="andre-varer-list">
                <!-- Products will be listed here -->
            </div>
        </div>
    </div>

    <template id="login-modal-template"><div class="modal-content"><div class="modal-header"><h2>Login</h2><span class="close-btn">&times;</span></div><div class="modal-controls" style="flex-direction: column; gap: 10px;"><input type="email" id="login-email-input" placeholder="E-mail" style="font-size: 18px; padding: 10px; border-radius: 8px; border: 1px solid #ccc;" autocomplete="off"><input type="password" id="login-password-input" placeholder="Adgangskode" style="font-size: 18px; padding: 10px; border-radius: 8px; border: 1px solid #ccc;" autocomplete="new-password"><button id="perform-login-btn" class="action-button" style="background-color: var(--success-color); margin-top: 10px; margin-bottom: 0;">Log ind</button><button id="developer-login-btn" class="action-button" style="background-color: var(--warning-color); margin-top: 10px; margin-bottom: 0;">Developer Login</button><p id="login-error-msg" style="color: var(--danger-color); text-align: center; display: none; margin-top: 10px;"></p></div></div></template>
    <template id="user-modal-template"><div class="modal-content"><div class="modal-header"><h2 id="user-modal-title">V√¶lg en kunde</h2><div id="user-filter-buttons" class="user-filter-buttons" style="display: none;"><button id="filter-all-btn" class="filter-btn active">Vis Alle</button><button id="filter-children-btn" class="filter-btn">Vis B√∏rn</button><button id="filter-adults-btn" class="filter-btn">Vis Voksne</button></div><span class="close-btn">&times;</span></div><div id="admin-controls-modal"></div><div class="modal-controls"><input type="text" id="search-user-input" placeholder="S√∏g efter navn eller nummer..." autocomplete="off" spellcheck="false" autocapitalize="off"></div><div class="user-list-header"><div id="sort-by-name-btn" class="sort-header active">Navn</div><div id="sort-by-number-btn" class="sort-header">Nummer</div><div id="sort-by-balance-btn" class="sort-header">Saldo</div><div class="static-header">Handling</div></div><div id="modal-user-list" class="modal-user-list"></div></div></template>
    <template id="admin-user-manager-modal-template"><div class="modal-content"><div class="modal-header"><h2>Rediger Brugere</h2><span class="close-btn">&times;</span></div><div id="admin-rules-inline" style="background: linear-gradient(135deg, rgba(168, 85, 247, 0.06), rgba(255, 255, 255, 0.98)); border: 1px solid rgba(168, 85, 247, 0.2); border-radius: 12px; padding: 12px 15px; margin-bottom: 12px;"><div style="font-weight: 600; font-size: 13px; color: #6b21a8; margin-bottom: 10px;">Admin Regler</div><label style="display: flex; align-items: center; margin-bottom: 10px; cursor: pointer; font-size: 13px;"><input type="checkbox" id="admin-rules-show-admins-inline" style="margin-right: 10px; cursor: pointer;"><div><strong>Vis Admins i 'V√¶lg Bruger' listen</strong><div style="font-size: 11px; color: #666; margin-top: 2px;">Voksne kan v√¶lges som kunder i caf√©en</div></div></label><label style="display: flex; align-items: center; cursor: pointer; font-size: 13px;"><input type="checkbox" id="admin-rules-admins-free-inline" style="margin-right: 10px; cursor: pointer;"><div><strong>Admins skal ikke betale</strong><div style="font-size: 11px; color: #666; margin-top: 2px;">Voksne k√∏ber for 0 kr (registreres stadig i historik)</div></div></label></div><div id="admin-controls-modal"><button id="add-user-btn-modal" class="action-button admin-btn" style="margin-bottom: 10px;">‚ûï Tilf√∏j Ny Bruger</button><button id="auto-import-open-btn" class="action-button admin-btn" style="margin-bottom: 10px;">Opret/Opdater automatisk</button></div><div class="modal-controls"><input type="text" id="admin-search-user-input" placeholder="S√∏g efter navn eller nummer..." autocomplete="off" spellcheck="false" autocapitalize="off"></div><div class="user-list-header"><div id="admin-sort-by-name-btn" class="sort-header active">Navn</div><div id="admin-sort-by-number-btn" class="sort-header">Nummer</div><div id="admin-sort-by-grade-btn" class="sort-header">Klasse</div><div id="admin-sort-by-balance-btn" class="sort-header">Saldo</div><div class="static-header">Handlinger</div></div><div id="admin-modal-user-list" class="modal-user-list"></div></div></template>
    <template id="avatar-picker-modal-template"><div class="modal-content"><div class="modal-header"><h2>Min Flango Status</h2><span class="close-btn">&times;</span></div><div id="avatar-picker-scroll-wrapper">
        <div id="avatar-picker-summary"></div>
        <hr style="margin: 15px 0; border-color: #eee;">
        <div id="avatar-carousel-container" class="avatar-carousel-container"></div>
    </div></div></template>
    <template id="add-edit-product-modal-template"><div class="modal-content" style="height: auto; max-height: 90%; display: flex; flex-direction: column;"><div class="modal-header"><h2 id="product-form-title">Tilf√∏j Produkt</h2><span class="close-btn">&times;</span></div><div id="product-form-fields" style="overflow-y: auto; flex: 1; padding-right: 10px;"></div><button id="save-product-btn" class="action-button" style="background-color: var(--success-color); margin-top: 15px; margin-bottom: 0; flex-shrink: 0;">Gem Produkt</button></div></template>
    <template id="quick-login-modal-template"><div class="modal-content"><div class="modal-header"><h2>Hvem er du?</h2><span class="close-btn">&times;</span></div><div id="quick-login-user-list" class="modal-user-list"></div><p id="quick-login-error-msg" style="color: var(--danger-color); text-align: center; display: none; margin-top: 10px;"></p></div></template>
    <template id="add-edit-user-modal-template"><div class="modal-content" style="height: auto; max-height: 90%;"><div class="modal-header"><h2 id="user-form-title">Tilf√∏j Ny Bruger</h2><span class="close-btn">&times;</span></div><div id="user-form-fields"></div><button id="save-user-btn" class="action-button" style="background-color: var(--success-color); margin-top: 15px; margin-bottom: 0;">Gem Bruger</button></div></template><template id="balance-modal-template"><div class="modal-content" style="height: auto; max-width: 400px;"><div class="modal-header"><h2 id="balance-form-title">Rediger Saldo</h2><span class="close-btn">&times;</span></div><div id="balance-form-fields"></div><button id="save-balance-btn" class="action-button" style="background-color: var(--success-color); margin-top: 15px; margin-bottom: 0;">Gem</button></div></template>
    <template id="edit-user-detail-modal-template"><div class="modal-content edit-user-modal"><div class="modal-header"><h2 id="edit-user-detail-title">Rediger Bruger</h2><span class="close-btn">&times;</span></div><div class="edit-user-form"><p id="edit-user-balance-display" class="balance-display"></p><div class="form-group"><label for="edit-user-name-input">Brugernavn</label><input type="text" id="edit-user-name-input" placeholder="Fx. Sofie Hansen" autocomplete="off" spellcheck="false" autocapitalize="off"></div><div class="form-group"><label for="edit-user-number-input">Brugernummer</label><input type="text" id="edit-user-number-input" placeholder="Fx. 1234" autocomplete="off" spellcheck="false" autocapitalize="off"></div><div class="form-group"><label for="edit-user-grade-level">Klasse</label><select id="edit-user-grade-level"><option value="">Ikke angivet</option><option value="0">0. klasse</option><option value="1">1. klasse</option><option value="2">2. klasse</option><option value="3">3. klasse</option><option value="4">4. klasse</option><option value="5">5. klasse</option><option value="6">6. klasse</option><option value="7">7. klasse</option><option value="8">8. klasse</option><option value="9">9. klasse</option></select></div><div class="form-group"><label for="edit-user-deposit-input">Indbetal Penge</label><div class="inline-input-row"><input type="number" id="edit-user-deposit-input" placeholder="Bel√∏b" step="0.01" autocomplete="off" spellcheck="false" autocapitalize="off"><div class="preset-buttons"><button type="button" class="preset-btn" data-amount="50">+50</button><button type="button" class="preset-btn" data-amount="100">+100</button><button type="button" class="preset-btn" data-amount="150">+150</button><button type="button" class="preset-btn" data-amount="200">+200</button></div></div></div><div class="form-row"><div class="form-group half"><label for="edit-user-balance-input">S√¶t Ny Saldo</label><input type="number" id="edit-user-balance-input" placeholder="Fx. 250" step="0.01" autocomplete="off" spellcheck="false" autocapitalize="off"></div><div class="form-group half"><label for="edit-user-pin-input">Ny PIN (4 cifre)</label><input type="text" id="edit-user-pin-input" placeholder="1234" maxlength="4" autocomplete="off" spellcheck="false" autocapitalize="off"></div></div><div class="form-group"><label>Badge</label><div class="badge-row"><span id="current-badge-label">Ingen badge</span><button type="button" id="assign-badge-btn" class="action-button secondary-action">Tildel Badge</button></div><p id="assign-badge-note" class="assign-badge-note" style="display:none;"></p><div id="edit-user-badge-display" class="simple-badge-row compact"></div></div></div><div class="modal-actions"><button id="save-edit-user-btn" class="action-button" style="width:100%;">Gem</button><button id="delete-edit-user-btn" class="action-button" style="width:100%; background-color: var(--danger-color); margin-top: 10px;">Slet Bruger</button></div></div></template>
    <template id="assign-badge-modal-template"><div class="modal-content assign-badge-modal"><div class="modal-header"><h2 id="assign-badge-title">Tildel Badge</h2><span class="close-btn">&times;</span></div><div class="badge-category-list">
        <details class="badge-section" open>
            <summary>Faglige &amp; praktiske kompetencer üß†</summary>
            <div class="badge-grid">
                <button class="badge-option" data-badge="SANS FOR DETALJER">SANS FOR DETALJER</button>
                <button class="badge-option" data-badge="Orden & Overblik">Orden & Overblik</button>
                <button class="badge-option" data-badge="K√∏kken-Kaptajn">K√∏kken-Kaptajn</button>
                <button class="badge-option" data-badge="Hygiejne-Helten">Hygiejne-Helten</button>
                <button class="badge-option" data-badge="Service-Specialist">Service-Specialist</button>
                <button class="badge-option" data-badge="Flango Fejlfinder">Flango Fejlfinder</button>
            </div>
        </details>
        <details class="badge-section">
            <summary>Sociale kompetencer & relationsarbejdeü§ù</summary>
            <div class="badge-grid">
                <button class="badge-option" data-badge="En God Kammerat">En God Kammerat</button>
                <button class="badge-option" data-badge="Tryghedsskaber">Tryghedsskaber</button>
                <button class="badge-option" data-badge="Team-Spiller">Team-Spiller</button>
                <button class="badge-option" data-badge="Empati-Ekspedient">Empati-Ekspedient</button>
                <button class="badge-option" data-badge="Rolig Under Pres">Rolig Under Pres</button>
                <button class="badge-option" data-badge="God Til At Lytte">God Til At Lytte</button>
                <button class="badge-option" data-badge="SKABER GOD STEMNING">SKABER GOD STEMNING</button>
                <button class="badge-option" data-badge="Rolig & Rar">Rolig & Rar</button>
            </div>
        </details>
        <details class="badge-section">
            <summary>Indsats, flid og vedholdenhedüí™</summary>
            <div class="badge-grid">
                <button class="badge-option" data-badge="SUPER FLITTIG">SUPER FLITTIG</button>
                <button class="badge-option" data-badge="St√¶dig Som En Stjerne">St√¶dig Som En Stjerne</button>
                <button class="badge-option" data-badge="Vedholdende">Vedholdende</button>
                <button class="badge-option" data-badge="Altid klar!">Altid klar!</button>
                <button class="badge-option" data-badge="Topengageret Flango Fighter">Topengageret Flango Fighter</button>
                <button class="badge-option image-badge" data-badge="H√•rdtarbejdende"><img src="Icons/webp/Badge/Haardtarbejdende.webp" alt="H√•rdtarbejdende badge"></button>
                <button class="badge-option" data-badge="M√•nedens Ekspedient">M√•nedens Ekspedient</button>
                <button class="badge-option" data-badge="Top S√¶lger">Top S√¶lger</button>
            </div>
        </details>
        <details class="badge-section">
            <summary>Modning, ansvar og selvst√¶ndighedüå±</summary>
            <div class="badge-grid">
                <button class="badge-option" data-badge="Ansvar Med Omhu">Ansvar Med Omhu</button>
                <button class="badge-option" data-badge="Omsorgsfuld Ekspedient">Omsorgsfuld Ekspedient</button>
                <button class="badge-option" data-badge="Selvst√¶ndig Stjerne">Selvst√¶ndig Stjerne</button>
                <button class="badge-option" data-badge="Problemknuser">Problemknuser</button>
                <button class="badge-option" data-badge="Tryg & Trofast">Tryg & Trofast</button>
                <button class="badge-option" data-badge="Skrap Til Sikkerhed">Skrap Til Sikkerhed</button>
            </div>
        </details>
        <details class="badge-section">
            <summary>Kreativitet & initiativüé®</summary>
            <div class="badge-grid">
                <button class="badge-option" data-badge="Initiativtager">Initiativtager</button>
                <button class="badge-option" data-badge="Id√©-Maskinen">Id√©-Maskinen</button>
                <button class="badge-option" data-badge="Kreativ Kok">Kreativ Kok</button>
                <button class="badge-option" data-badge="Opfinder">Opfinder</button>
            </div>
        </details>
        <details class="badge-section">
            <summary>K√∏kkenrelaterede og sjove badgeüßÅ</summary>
            <div class="badge-grid">
                <button class="badge-option" data-badge="Byens B√∏rne-Kok">Byens B√∏rne-Kok</button>
                <button class="badge-option image-badge" data-badge="Pandekage Mester"><img src="Icons/webp/Badge/pandekagemester.webp" alt="Pandekage Mester badge"></button>
                <button class="badge-option" data-badge="Toast-Fabrik">Toast-Fabrik</button>
                <button class="badge-option" data-badge="Vaffel-Vokter">Vaffel-Vokter</button>
            </div>
        </details>
        <details class="badge-section">
            <summary>Adf√¶rd & attitude-badges‚≠ê</summary>
            <div class="badge-grid">
                <button class="badge-option" data-badge="SUPER H√òFLIG">SUPER H√òFLIG</button>
                <button class="badge-option" data-badge="Hj√¶lpsom">Hj√¶lpsom</button>
                <button class="badge-option image-badge" data-badge="God Stil"><img src="Icons/webp/Badge/GodStil.webp" alt="God Stil badge"></button>
                <button class="badge-option" data-badge="Ekstra Ansvarlig">Ekstra Ansvarlig</button>
                <button class="badge-option" data-badge="Dagens Stjerne">Dagens Stjerne</button>
            </div>
        </details>
    </div></div></template>
    <template id="event-admin-modal-template"><div class="modal-content event-admin-modal"><div class="modal-header event-admin-header"><button id="event-admin-back-btn" class="event-back-btn event-admin-back-hidden" type="button">‚Üê Tilbage</button><h2 id="event-admin-title" class="event-admin-title">Arrangementer</h2><span class="close-btn">&times;</span></div><div id="event-list-view" class="event-view"><div class="event-filter-bar"><button id="event-filter-active" class="event-filter-btn active" data-filter="active">Kommende</button><button id="event-filter-past" class="event-filter-btn" data-filter="past">Afsluttede</button><button id="event-filter-cancelled" class="event-filter-btn" data-filter="cancelled">Aflyste</button><button id="event-create-btn" class="event-create-btn">+ Opret Arrangement</button></div><div id="event-list-container" class="event-list-container"></div><div id="event-list-empty" class="event-list-empty" style="display:none;"><p>Ingen arrangementer fundet.</p></div></div><div id="event-detail-view" class="event-view" style="display:none;"><div id="event-detail-header" class="event-detail-header"></div><div id="event-detail-summary" class="event-detail-summary"></div><div id="event-detail-actions" class="event-detail-actions"></div><h4 class="event-reg-list-header">Tilmeldte brugere</h4><div id="event-reg-list" class="event-reg-list"></div></div><div id="event-form-view" class="event-view" style="display:none;"><h3 id="event-form-subtitle">Opret Arrangement</h3><div class="event-form"><input type="text" id="event-form-title" placeholder="Titel *" required><textarea id="event-form-description" placeholder="Beskrivelse (valgfrit)" rows="3"></textarea><input type="number" id="event-form-price" placeholder="Pris (kr.)" step="0.01" value="0.00"><input type="number" id="event-form-capacity" placeholder="Kapacitet (tom = ubegr&#230;nset)" min="1"><label style="font-size:13px;color:#666;">Startdato og -tid *</label><input type="datetime-local" id="event-form-start" required><label style="font-size:13px;color:#666;">Slutdato og -tid (valgfrit)</label><input type="datetime-local" id="event-form-end"><div class="event-class-section"><label style="font-size:13px;color:#666;">Tilladt klasse (ingen valgt = alle)</label><div id="event-form-classes" class="event-class-checkboxes"></div></div><div class="event-form-actions"><button id="event-form-save-btn" class="event-save-btn">Gem</button><button id="event-form-cancel-btn" class="event-cancel-btn">Annuller</button></div></div></div></div></template>

    <!-- DISABLED: Theme picker (flango-unstoppable is the only active theme) -->
    <!--
    <button id="open-theme-picker" style="display:none;"></button>
    <div id="theme-picker-backdrop" class="theme-picker-backdrop" style="display:none;">
        <div class="theme-picker-modal">
            <h2>V√¶lg tema</h2>
            <div class="theme-option">
                <input type="radio" name="flango-theme" id="theme-flango-unstoppable" value="flango-unstoppable" checked>
                <label for="theme-flango-unstoppable">
                    <strong>Flango Unstoppable</strong><br>
                    Fedt og energisk design
                </label>
            </div>
            <div class="theme-picker-actions">
                <button id="theme-picker-close" class="settings-button">Luk</button>
            </div>
        </div>
    </div>
    -->

    <!-- Indstillinger modal -->
    <div id="settings-modal-backdrop" class="settings-modal-backdrop" style="display:none;">
        <div class="settings-modal">
            <div class="settings-modal-header">
                <button id="settings-modal-back-btn" class="modal-back-btn-universal" type="button" style="display:none;">‚Üê Tilbage</button>
                <h2 id="settings-modal-title" class="settings-modal-title">Indstillinger</h2>
                <button id="settings-modal-close" class="settings-modal-close-btn">Luk</button>
            </div>
            <div id="settings-modal-content" class="settings-modal-content">
                <!-- Dynamisk indhold -->
            </div>
        </div>
    </div>

    <!-- Skjult knap til gear-menu (fortryd sidste k√∏b) -->
    <button id="undo-last-sale-btn" style="display:none;">Fortryd sidste k√∏b ‚Ü©Ô∏è</button>
    
    <audio id="audio-purchase" preload="auto"></audio>
    <audio id="audio-add-item" preload="auto"></audio>
    <audio id="audio-remove-item" preload="auto"></audio>
    <audio id="audio-error" preload="auto"></audio>
    <audio id="audio-login" src="sounds/Login/Login1.mp3" preload="auto"></audio>    
    <audio id="audio-balance-update" src="sounds/Accept/accepter-3.mp3" preload="auto"></audio>
    <audio id="audio-product-create" src="sounds/Accept/accepter-1.mp3" preload="auto"></audio>
    <audio id="audio-logout" src="sounds/Accept/accepter-7.mp3" preload="auto"></audio>
    <audio id="audio-preview" preload="auto"></audio>

    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script type="module" src="js/admin/auto-import-users.js"></script>
    <script type="module" src="js/app.js"></script>
</body>
</html>
